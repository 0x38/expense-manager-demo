<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-flex-layout/classes/iron-flex-layout.html">
<link rel="import" href="../bower_components/vaadin-icons/vaadin-icons.html">
<link rel="import" href="../bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/iron-localstorage/iron-localstorage.html">
<link rel="import" href="overview-page.html">
<link rel="import" href="login-page.html">
<link rel="import" href="../styles/app-theme.html">

<dom-module id="expense-app">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <neon-animated-pages id="pages" class="fit" selected="[[selected]]">
      <login-page token="[[token]]"></login-page>
      <overview-page token="[[token]]"></overview-page>
    </neon-animated-pages>
    <iron-localstorage id="tokenStorage" name="auth-token" value="{{token}}"></iron-localstorage>
  </template>

  <script>
    Polymer({
      is: 'expense-app',

      properties: {
        selected: {
          type: Number,
          notify: true,
          computed: '_selectPage(token)'
        },
        token: {
          type: String,
          notify: true
        }
      },

      listeners: {
        'logged-in': '_handleLogin',
        'logged-out': '_handleLogout'
      },

      _handleLogin: function (args) {
        this.token = args.detail.token;
        this.selected = 1;
      },

      _handleLogout: function () {
        this.token = null;
        this.selected = 0;
      },

      _selectPage: function (token) {
        return token ? 1 : 0;
      }
    });
  </script>
</dom-module>
