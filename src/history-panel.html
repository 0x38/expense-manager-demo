<html><head><link rel="import" href="../bower_components/polymer/polymer.html"><link rel="import" href="../bower_components/vaadin-charts/vaadin-bar-chart.html"><link rel="import" href="../bower_components/vaadin-charts/vaadin-column-chart.html"><link rel="import" href="moment-js.html"></head><body><dom-module id="history-panel"><template><style>:host{display:block;background:#f8f9f9;padding:20px 24px;}#container{display:flex;flex-direction:column;}.chart-title{@apply (--section-title);}#barchart::content text{font-family:'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;}#horizontal{display:none;}@media (max-width: 600px){.chart,
        #horizontal{display:none;}.total{height:64px;-ms-flex-direction:row;-webkit-flex-direction:row;flex-direction:row;}.total .sum{margin-left:12px;}}@media (max-width: 1124px){#horizontal{display:flex;}.chart-title{display:none;}#horizontal .chart-title{display:block;width:450px;}#total > span:first-child{@apply (--section-title);}#total{flex:1;margin-left:16px;}#total .sum{display:block;text-align:center;font-weight:200;font-size:32px;line-height:100px;}#barchart{display:none;}}@media (min-width: 1125px){.chart-title{margin-top:200px;}}</style><div id="container"><div class="chart"><h2 class="chart-title section-title">Last 12 Months in Total</h2><vaadin-bar-chart id="barchart"><title>&lt;style display="none"&gt;&lt;/style&gt;</title><chart background-color="transparent" height="400" width="250"></chart><exporting enabled="false"></exporting><x-axis><title>&lt;style display="none"&gt;&lt;/style&gt;</title><labels><chart-style>{"color": "#000"}</chart-style></labels></x-axis><y-axis><title>&lt;style display="none"&gt;&lt;/style&gt;</title></y-axis><tooltip formatter="function() { return '$' + this.y.toFixed(2); }"></tooltip><data-series name="$" data="[[seriesData]]"><color>#ffc13f</color></data-series><legend enabled="false"></legend></vaadin-bar-chart><div id="horizontal"><div><h2 class="chart-title section-title">Last 12 Months in Total</h2><vaadin-column-chart id="columnchart"><title>&lt;style display="none"&gt;&lt;/style&gt;</title><chart background-color="transparent" height="200" width="450"></chart><exporting enabled="false"></exporting><x-axis><title>&lt;style display="none"&gt;&lt;/style&gt;</title><labels><chart-style>{"color": "#000"}</chart-style></labels></x-axis><y-axis><title>&lt;style display="none"&gt;&lt;/style&gt;</title></y-axis><tooltip formatter="function() { return '$' + this.y.toFixed(2); }"></tooltip><data-series name="$" data="[[seriesData]]"><color>#ffc13f</color></data-series><legend enabled="false"></legend></vaadin-column-chart></div><div id="total"><span>To be reimbursed</span> <span class="sum">[[totalOwed]]</span></div></div></div></div></template><script>(function(){'use strict';Polymer({is:'history-panel',properties:{expenses:Array,seriesData:{type:Array,notify:!0}},observers:['update(expenses.*)'],update:function(){function b(g,h){var j,i=moment(g);return h.forEach(function(k){k.month===i.month()&&k.year===i.year()&&(j=k)}),j||(j={month:i.month(),year:i.year(),total:0},h.push(j)),j}function c(g,h){var i=moment().year(g.year).month(g.month),j=0===h||11===g.month?'YYYY MMM':'MMM';return i.format(j)}var d=this.expenses,e=[],f=moment().subtract(1,'years');d.filter(function(g){return moment(g.date).isAfter(f)}).forEach(function(g){b(g.date,e).total+=g.total}),this.seriesData=e.map(function(g){return g.total}),this.async(function(){this.$.barchart.chart.xAxis[0].setCategories(e.map(c)),this.$.barchart.chart.reflow(),this.$.columnchart.chart.xAxis[0].setCategories(e.map(c)),this.$.columnchart.chart.reflow()},50)}})})();</script></dom-module></body></html>